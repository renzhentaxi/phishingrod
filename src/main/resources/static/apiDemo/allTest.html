<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<table id="viewTable">
    <tr>
        <th>Email Address</th>
        <th>Last Modified</th>
        <th>Created At</th>
        <th>Parameters</th>
    </tr>
</table>
<script>


    //call getTargets
    getTargets(onTargetsReturned);

    // locates the table
    const table = document.querySelector("#viewTable");

    //api url
    const url = "http://localhost:8080/api/phishingTarget/all";

    //request data from the url
    fetch(url)
        .then((response) => response.json()) //converts response to json
        .then(json => {
                for (let jsonTarget of targets) {
                    let row = jsonToRow(jsonTarget);
                    table.appendChild(row);
                }

            }
        );


    // what phishingTarget json look like
    // {
    //     "id": 9,
    //     "createdAt": "2018-04-21T03:22:34.515+0000",
    //     "lastModified": "2018-04-21T03:22:34.515+0000",
    //     "emailAddress": "txi@gamil.com8",
    //     "parameters": {}
    // }

    //transforms a json object to a row using template literals
    function jsonToRow(phishingTarget) {
        const html = `
        <tr data-id="${phishingTarget.id}">
            <td>${phishingTarget.emailAddress}</td>
            <td>${phishingTarget.createdAt}</td>
            <td>${phishingTarget.lastModified}</td>
            <td>${phishingTarget.parameters}</td>
        </tr>`;

        return toNode(html);
    }

    //converts a string representation of a html node into an actual node.
    function toNode(html) {
        const template = document.createElement('template');
        html = html.trim();
        template.innerHTML = html;
        return template.content;
    }

</script>
</body>
</html>